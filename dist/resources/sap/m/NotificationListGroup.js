/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./library","sap/ui/core/Core","./NotificationListBase","sap/ui/core/InvisibleText","./ListItemBase","sap/ui/core/IconPool","sap/ui/core/library","sap/ui/Device","sap/m/Button","./NotificationListGroupRenderer","sap/ui/events/KeyCodes"],function(e,t,i,o,r,s,n,a,p,l,u){"use strict";var g=n.Priority;var I=e.ButtonType;var h=t.getLibraryResourceBundle("sap.m"),T=h.getText("NOTIFICATION_LIST_GROUP_EXPAND"),c=h.getText("NOTIFICATION_LIST_GROUP_COLLAPSE"),d=h.getText("NOTIFICATION_LIST_GROUP_READ"),f=h.getText("NOTIFICATION_LIST_GROUP_UNREAD"),y="sap-icon://slim-arrow-right",_="sap-icon://slim-arrow-down";var m=a.system.desktop?400:100;var N=i.extend("sap.m.NotificationListGroup",{metadata:{library:"sap.m",properties:{collapsed:{type:"boolean",group:"Behavior",defaultValue:false},autoPriority:{type:"boolean",group:"Behavior",defaultValue:true},showEmptyGroup:{type:"boolean",group:"Behavior",defaultValue:false},enableCollapseButtonWhenEmpty:{type:"boolean",group:"Behavior",defaultValue:false},showItemsCounter:{type:"boolean",group:"Behavior",defaultValue:true},authorName:{type:"string",group:"Appearance",defaultValue:"",deprecated:true},authorPicture:{type:"sap.ui.core.URI",multiple:false,deprecated:true},datetime:{type:"string",group:"Appearance",defaultValue:"",deprecated:true}},defaultAggregation:"items",aggregations:{items:{type:"sap.m.NotificationListItem",multiple:true,singularName:"item"},_collapseButton:{type:"sap.m.Button",multiple:false,visibility:"hidden"}},events:{onCollapse:{parameters:{collapsed:{type:"boolean"}}}}}});N.prototype._getCollapseButton=function(){var e=this.getAggregation("_collapseButton"),t=this.getCollapsed();if(!e){e=new p(this.getId()+"-collapseButton",{type:I.Transparent,icon:t?y:_,tooltip:t?T:c,press:function(){this.setCollapsed(!this.getCollapsed())}.bind(this)});this.setAggregation("_collapseButton",e,true)}return e};N.prototype.setCollapsed=function(e){var t=this.$(),i=this._getCollapseButton(),o="",r=!e&&this._shouldRenderOverflowToolbar();t.toggleClass("sapMNLGroupCollapsed",e);t.attr("aria-expanded",!e);if(!a.system.phone){r?o="block":o="none";t.find(".sapMNLGroupHeader .sapMNLIActions").css("display",o)}i.setIcon(e?y:_);i.setTooltip(e?T:c);this.setProperty("collapsed",e,true);if(a.system.phone&&this.getDomRef()){this._updatePhoneButtons()}this.fireOnCollapse({collapsed:e});return this};N.prototype.init=function(){this._groupTitleInvisibleText=new o({id:this.getId()+"-invisibleGroupTitleText"})};N.prototype.exit=function(){if(this._groupTitleInvisibleText){this._groupTitleInvisibleText.destroy();this._groupTitleInvisibleText=null}};N.prototype.getVisibleItems=function(){var e=this.getItems().filter(function(e){return e.getVisible()});return e};N.prototype._getVisibleItemsCount=function(){return this.getVisibleItems().length};N.prototype._getGroupTitleInvisibleText=function(){var e=this.getUnread()?f:d,t=h.getText("NOTIFICATION_LIST_GROUP_PRIORITY",this.getPriority()),i,o=[e,t];if(this.getShowItemsCounter()){i=h.getText("LIST_ITEM_COUNTER",this._getVisibleItemsCount());o.push(i)}return this._groupTitleInvisibleText.setText(o.join(" "))};N.prototype.getPriority=function(){if(!this.getAutoPriority()){return this.getProperty("priority")}var e=this.getAggregation("items");var t=g.None;if(e){e.forEach(function(e){t=b(t,e.getPriority())})}else{t=this.getProperty("priority")}return t};function b(e,t){if(e==t){return e}if(e=="None"){return t}if(e=="Low"&&t!="None"){return t}if(e=="Medium"&&(t!="None"&&t!="Low")){return t}return e}N.prototype.onBeforeRendering=function(){i.prototype.onBeforeRendering.apply(this,arguments);this._getCollapseButton().setVisible(this.getEnableCollapseButtonWhenEmpty()||this._getVisibleItemsCount()>0)};N.prototype._isMaxNumberReached=function(){return this.getItems().length>m};N.prototype._getMaxNumberReachedMsg=function(){return{title:h.getText("NOTIFICATION_LIST_GROUP_MAX_NOTIFICATIONS_TITLE",this.getItems().length-m),description:h.getText("NOTIFICATION_LIST_GROUP_MAX_NOTIFICATIONS_BODY")}};return N});